<%- include('partials/dashboardHead') %>

<body class="nk-body ui-rounder has-sidebar ui-light ">
  <div class="nk-app-root">
    <div class="nk-main ">
      <div class="nk-sidebar is-light nk-sidebar-fixed " data-content="sidebarMenu">
        <div class="nk-sidebar-element nk-sidebar-head">
          <div class="nk-sidebar-brand"><a href="/admin-dashboard" class="logo-link nk-sidebar-logo"><img src="/images/enbridge.jpg" style="width: 100px;" alt="Company-icon"></a></div>
          <div class="nk-menu-trigger me-n2"><a href="#" class="nk-nav-toggle nk-quick-nav-icon d-xl-none" data-target="sidebarMenu"><em class="icon ni ni-arrow-left"></em></a></div>
        </div>
        <div class="nk-sidebar-element">
          <div class="nk-sidebar-content">
            <div class="nk-sidebar-menu" data-simplebar="">
              <%- include('partials/adminNav') %>
            </div>
          </div>
        </div>
      </div>
      <div class="nk-wrap ">
        <div class="nk-header is-light nk-header-fixed is-light">
          <div class="container-xl wide-xl">
            <div class="nk-header-wrap">
              <div class="nk-menu-trigger d-xl-none ms-n1 me-3"><a href="#" class="nk-nav-toggle nk-quick-nav-icon" data-target="sidebarMenu"><em class="icon ni ni-menu"></em></a></div>
              <div class="nk-header-brand d-xl-none"><a href="/admin-dashboard" class="logo-link"><img src="/images/enbridge.jpg" style="width: 100px;" alt="Company-icon"></a></div>
              <div class="nk-header-tools">
                <ul class="nk-quick-nav">
                  <li class="dropdown user-dropdown"><a href="#" class="dropdown-toggle" data-bs-toggle="dropdown">
                      <div class="user-toggle">
                        <div class="user-avatar sm"><em class="icon ni ni-user-alt"></em>
                        </div>
                      </div>
                    </a>
                    <div class="dropdown-menu dropdown-menu-md dropdown-menu-end">
                      <div class="dropdown-inner user-card-wrap bg-lighter d-none d-md-block">
                        <div class="user-card">
                          <div class="user-avatar"><span>
                              <% let letter = user.firstName.split('')[0] %>
                              <%= letter %>
                            </span></div>
                          <div class="user-info"><span class="lead-text"><%= user.firstName %></span><span class="sub-text"><%= user.email %></span></div>
                        </div>
                      </div>
                      <div class="dropdown-inner">
                        <ul class="link-list">
                          <li><a href="/admin-profile"><em class="icon ni ni-user-alt"></em><span>View
                                Profile</span></a></li>
                        </ul>
                      </div>

                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="nk-content nk-content-fluid">
          <div class="container-xl wide-xl">
            <div class="nk-content-body">
              <div class="nk-block-head nk-page-head nk-block-head-sm">
                <div class="nk-block-head-between">
                  <div class="nk-block-head-content">
                    <h3 class="nk-block-title page-title">Admin Dashboard</h3>
                  </div>
                </div>
              </div>
              <div class="nk-block">
                <div class="row g-gs">
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Total Users
                          </div>
                        </div>
                        <h5 class="fs-1"><%= users.length %><small class="fs-3"> users</small></h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Pending Deposits
                          </div>
                        </div>
                        <h5 class="fs-1"><%= pendingDeposits.length %><small class="fs-3"> pendning deposits</small>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Pending Withdrawals</div>
                        </div>
                        <h5 class="fs-1"><%= pendingWithdrawals.length %><small class="fs-3"> pending withdrawals</small>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Active Investments</div>
                        </div>
                        <h5 class="fs-1"><%= activeInvestments.length %><small class="fs-3"> active investments</small>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Total Deposits
                          </div>
                        </div>
                        <h5 class="fs-1">
                          <% let deposits = 0 %>
                          <% totalDeposits.forEach(function(deposit){ %>
                          <% deposits += deposit.amount %>
                          <% }) %>
                          $ <%= deposits %>
                          </small>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Total Withrawal
                          </div>
                        </div>
                        <h5 class="fs-1">
                          <% let withdrawals = 0 %>
                          <% totalWithdrawals.forEach(function(withdrawal) {%>
                          <% withdrawals += withdrawal.amount %>
                          <% }) %>
                          $ <%= withdrawals %>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xxl-3">
                    <div class="card card-full">
                      <div class="card-inner">
                        <div class="d-flex align-items-center justify-content-between mb-1">
                          <div class="fs-6 text-opacity-75 mb-0">Pending Support</div>
                        </div>
                        <h5 class="fs-1"><%= pendingSupports.length %><small class="fs-3"> Pending supports</small>
                        </h5>
                      </div>
                    </div>
                  </div>
                </div>
              </div>





              <div class="nk-block">
                <div class="col-lg-14 col-xl-14">
                  <div class="card card-bordered card-preview">
                    <div class="card-inner">
                      <div class="table-responsive">
                        <table class="table">
                          <thead class="thead-dark">
                            <tr>
                              <th scope="col">#</th>
                              <th scope="col">Type</th>
                              <th scope="col">Trxn Id</th>
                              <th scope="col">Amount</th>
                              <th scope="col">User</th>
                              <th scope="col">Time</th>
                              <th scope="col">Date</th>
                              <th scope="col">Method</th>
                              <th scope="col">Status</th>
                              <th scope="col">Wallet</th>
                            </tr>
                          </thead>
                          <tbody>
                            <% transactions.forEach(function(transaction, i){ %>
                            <tr>
                              <td scope="row"><%= i + 1 %></td>
                              <td><%= transaction.type %></td>
                              <td><%= transaction.id %></td>
                              <td>$ <%= transaction.amount %></td>
                              <td><%= transaction.user.email %></td>
                              <td><%= transaction.time %></td>
                              <td><%= (new Date(transaction.date)).toLocaleDateString('en-GB')%></td>
                              <td><%= transaction.wallet %></td>
                              <td>
                                <% if(transaction.status==='pending' ){ %>
                                <div class="badge badge-dim bg-warning rounded-pill">
                                  <%= transaction.status %>
                                </div>
                                <% }else if(transaction.status==='confirmed' ){ %>
                                <div class="badge badge-dim bg-success rounded-pill">
                                  <%= transaction.status %>
                                </div>
                                <% }else if(transaction.status==='declined' ){ %>
                                <div class="badge badge-dim bg-danger rounded-pill">
                                  <%= transaction.status %>
                                  <% } %>
                              </td>
                              <td><%= transaction.address %></td>
                            </tr>
                            <% }) %>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <%- include('partials/dashboardFooter') %>